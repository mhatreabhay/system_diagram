<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SystemDraw â€” System Design Diagrams</title>
  <link rel="stylesheet" href="css/styles.css?v=4">
  <!-- Rough.js for hand-drawn aesthetic -->
  <script src="https://cdn.jsdelivr.net/npm/roughjs@4.6.6/bundled/rough.min.js"></script>
</head>
<body>
  <!-- Top Toolbar -->
  <div id="toolbar">
    <div class="tool-group">
      <button class="tool-btn active" data-tool="select" title="Select (V)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"/>
        </svg>
      </button>
      <button class="tool-btn" data-tool="rectangle" title="Rectangle (R)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="18" height="18" rx="2"/>
        </svg>
      </button>
      <button class="tool-btn" data-tool="ellipse" title="Ellipse (O)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <ellipse cx="12" cy="12" rx="10" ry="8"/>
        </svg>
      </button>
      <button class="tool-btn" data-tool="diamond" title="Diamond (D)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2l10 10-10 10L2 12z"/>
        </svg>
      </button>
      <button class="tool-btn" data-tool="line" title="Line (L)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="5" y1="19" x2="19" y2="5"/>
        </svg>
      </button>
      <button class="tool-btn" data-tool="arrow" title="Arrow (A)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="5" y1="19" x2="19" y2="5"/>
          <polyline points="12 5 19 5 19 12"/>
        </svg>
      </button>
      <button class="tool-btn" data-tool="freehand" title="Freehand (P)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 17c3-3 6 2 9 0s6-5 9-3"/>
        </svg>
      </button>
      <button class="tool-btn" data-tool="text" title="Text (T)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="4 7 4 4 20 4 20 7"/>
          <line x1="12" y1="4" x2="12" y2="20"/>
          <line x1="8" y1="20" x2="16" y2="20"/>
        </svg>
      </button>
      <button class="tool-btn" data-tool="hand" title="Hand / Pan (H)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 11V6a2 2 0 0 0-4 0v1"/>
          <path d="M14 10V4a2 2 0 0 0-4 0v6"/>
          <path d="M10 10.5V6a2 2 0 0 0-4 0v8"/>
          <path d="M18 8a2 2 0 0 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.42-3.42a2 2 0 0 1 2.83-2.83L8 16"/>
        </svg>
      </button>

      <!-- System Shapes Dropdown -->
      <div class="shape-dropdown-wrapper">
        <button class="tool-btn" id="shapesBtn" title="System Shapes">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <ellipse cx="12" cy="5" rx="8" ry="3"/>
            <path d="M4 5v14c0 1.66 3.58 3 8 3s8-1.34 8-3V5"/>
            <path d="M4 12c0 1.66 3.58 3 8 3s8-1.34 8-3"/>
          </svg>
          <span class="dropdown-caret">&#9662;</span>
        </button>
        <div class="shape-dropdown" id="shapeDropdown">
          <button class="dropdown-item" data-systool="database" data-label="Database">&#128451; Database</button>
          <button class="dropdown-item" data-systool="cache" data-label="Cache">&#9889; Cache</button>
          <button class="dropdown-item" data-systool="storage" data-label="Storage">&#128230; Storage</button>
          <button class="dropdown-item" data-systool="datawarehouse" data-label="Data Warehouse">&#127970; Data Warehouse</button>
          <button class="dropdown-item" data-systool="search" data-label="Search">&#128269; Search</button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item" data-systool="server" data-label="Server">&#9881; Server</button>
          <button class="dropdown-item" data-systool="microservice" data-label="Microservice">&#11047; Microservice</button>
          <button class="dropdown-item" data-systool="function" data-label="Function">&#955; Function</button>
          <button class="dropdown-item" data-systool="container" data-label="Container">&#128230; Container</button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item" data-systool="loadbalancer" data-label="Load Balancer">&#9878; Load Balancer</button>
          <button class="dropdown-item" data-systool="apigateway" data-label="API Gateway">&#128295; API Gateway</button>
          <button class="dropdown-item" data-systool="cdn" data-label="CDN">&#127760; CDN</button>
          <button class="dropdown-item" data-systool="cloud" data-label="Cloud">&#9729; Cloud</button>
          <button class="dropdown-item" data-systool="firewall" data-label="Firewall">&#128737; Firewall</button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item" data-systool="queue" data-label="Queue">&#10145; Queue</button>
          <button class="dropdown-item" data-systool="pubsub" data-label="Pub/Sub">&#128227; Pub/Sub</button>
          <button class="dropdown-item" data-systool="eventbus" data-label="Event Bus">&#128232; Event Bus</button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item" data-systool="user" data-label="User">&#128100; User</button>
          <button class="dropdown-item" data-systool="browser" data-label="Browser">&#127760; Browser</button>
          <button class="dropdown-item" data-systool="mobile" data-label="Mobile">&#128241; Mobile</button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item" data-systool="monitor" data-label="Monitor">&#128200; Monitor</button>
          <button class="dropdown-item" data-systool="logger" data-label="Logger">&#128220; Logger</button>
          <button class="dropdown-item" data-systool="scheduler" data-label="Scheduler">&#9202; Scheduler</button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item" data-systool="notification" data-label="Notification">&#128276; Notification</button>
          <button class="dropdown-item" data-systool="auth" data-label="Auth">&#128274; Auth</button>
          <button class="dropdown-item" data-systool="externalapi" data-label="External API">&#128279; External API</button>
        </div>
      </div>
    </div>

    <div class="toolbar-separator"></div>

    <!-- Actions -->
    <div class="tool-group">
      <button class="action-btn" id="undoBtn" title="Undo (Ctrl+Z)">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="1 4 1 10 7 10"/>
          <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/>
        </svg>
      </button>
      <button class="action-btn" id="redoBtn" title="Redo (Ctrl+Y)">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="23 4 23 10 17 10"/>
          <path d="M20.49 15a9 9 0 1 1-2.13-9.36L23 10"/>
        </svg>
      </button>
      <button class="action-btn" id="deleteBtn" title="Delete (Del)">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="3 6 5 6 21 6"/>
          <path d="M19 6l-2 14H7L5 6"/>
          <path d="M10 11v6"/>
          <path d="M14 11v6"/>
          <path d="M9 6V4h6v2"/>
        </svg>
      </button>
    </div>

    <div class="toolbar-separator"></div>

    <div class="tool-group">
      <button class="action-btn" id="clearAllBtn" title="Clear All">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2v20M2 12h20"/>
          <circle cx="12" cy="12" r="10"/>
          <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/>
        </svg>
      </button>
      <button class="action-btn" id="exportPngBtn" title="Export PNG">PNG</button>
      <button class="action-btn" id="exportJsonBtn" title="Save as JSON">Save</button>
      <button class="action-btn" id="importJsonBtn" title="Load from JSON">Load</button>
      <input type="file" id="importFileInput" accept=".json" style="display:none">
    </div>

    <div class="toolbar-spacer"></div>

    <div class="tool-group">
      <button class="action-btn" id="zoomInBtn" title="Zoom In">+</button>
      <span id="zoomLevel">100%</span>
      <button class="action-btn" id="zoomOutBtn" title="Zoom Out">âˆ’</button>
      <button class="action-btn" id="zoomResetBtn" title="Reset Zoom">Reset</button>
    </div>
  </div>

  <!-- Main container -->
  <div id="mainContainer">
    <!-- Left Shape Ribbon -->
    <div id="shapeRibbon">
      <div class="ribbon-category" data-category="database">
        <div class="ribbon-icon" title="Database"><svg width="20" height="20" viewBox="0 0 20 20"><ellipse cx="10" cy="5" rx="7" ry="3" fill="none" stroke="currentColor" stroke-width="1.5"/><path d="M3 5v10c0 1.66 3.13 3 7 3s7-1.34 7-3V5" fill="none" stroke="currentColor" stroke-width="1.5"/></svg></div>
        <div class="ribbon-flyout">
          <div class="flyout-title">Database</div>
          <button class="ribbon-item" data-systool="database" data-label="Database">ğŸ—ƒ Database</button>
          <button class="ribbon-item" data-systool="cache" data-label="Cache">&#9889; Cache</button>
          <button class="ribbon-item" data-systool="storage" data-label="Storage">ğŸ“¦ Storage</button>
          <button class="ribbon-item" data-systool="datawarehouse" data-label="Data Warehouse">ğŸ¢ Data Warehouse</button>
          <button class="ribbon-item" data-systool="search" data-label="Search">ğŸ” Search</button>
          <hr class="flyout-divider">
          <div class="flyout-subtitle">Azure</div>
          <button class="ribbon-item" data-systool="azuresql" data-label="Azure SQL">&#x1F4BE; Azure SQL</button>
          <button class="ribbon-item" data-systool="cosmosdb" data-label="Cosmos DB">&#x1F30D; Cosmos DB</button>
          <button class="ribbon-item" data-systool="azuremysql" data-label="Azure MySQL">&#x1F42C; Azure MySQL</button>
          <button class="ribbon-item" data-systool="azurepostgres" data-label="Azure PostgreSQL">&#x1F418; Azure PostgreSQL</button>
          <button class="ribbon-item" data-systool="sqlmanaged" data-label="SQL Managed Instance">&#x1F3E2; SQL Managed Instance</button>
          <button class="ribbon-item" data-systool="rediscache" data-label="Redis Cache">&#x26A1; Redis Cache</button>
          <button class="ribbon-item" data-systool="datafactory" data-label="Data Factory">&#x1F3ED; Data Factory</button>
          <button class="ribbon-item" data-systool="synapse" data-label="Synapse Analytics">&#x1F4CA; Synapse Analytics</button>
        </div>
      </div>
      <div class="ribbon-category" data-category="compute">
        <div class="ribbon-icon" title="Compute">&#9881;</div>
        <div class="ribbon-flyout">
          <div class="flyout-title">Compute</div>
          <button class="ribbon-item" data-systool="server" data-label="Server">&#9881; Server</button>
          <button class="ribbon-item" data-systool="microservice" data-label="Microservice">&#11047; Microservice</button>
          <button class="ribbon-item" data-systool="function" data-label="Function">&lambda; Function</button>
          <button class="ribbon-item" data-systool="container" data-label="Container">ğŸ“¦ Container</button>
        </div>
      </div>
      <div class="ribbon-category" data-category="network">
        <div class="ribbon-icon" title="Network">ğŸŒ</div>
        <div class="ribbon-flyout">
          <div class="flyout-title">Network</div>
          <button class="ribbon-item" data-systool="loadbalancer" data-label="Load Balancer">&#9878; Load Balancer</button>
          <button class="ribbon-item" data-systool="apigateway" data-label="API Gateway">ğŸ”§ API Gateway</button>
          <button class="ribbon-item" data-systool="cdn" data-label="CDN">ğŸŒ CDN</button>
          <button class="ribbon-item" data-systool="cloud" data-label="Cloud">&#9729; Cloud</button>
          <button class="ribbon-item" data-systool="firewall" data-label="Firewall">ğŸ›¡ Firewall</button>
        </div>
      </div>
      <div class="ribbon-category" data-category="messaging">
        <div class="ribbon-icon" title="Messaging">ğŸ“¨</div>
        <div class="ribbon-flyout">
          <div class="flyout-title">Messaging</div>
          <button class="ribbon-item" data-systool="queue" data-label="Queue">&#10145; Queue</button>
          <button class="ribbon-item" data-systool="pubsub" data-label="Pub/Sub">ğŸ“£ Pub/Sub</button>
          <button class="ribbon-item" data-systool="eventbus" data-label="Event Bus">ğŸ“¨ Event Bus</button>
        </div>
      </div>
      <div class="ribbon-category" data-category="clients">
        <div class="ribbon-icon" title="Clients">ğŸ‘¤</div>
        <div class="ribbon-flyout">
          <div class="flyout-title">Clients</div>
          <button class="ribbon-item" data-systool="user" data-label="User">ğŸ‘¤ User</button>
          <button class="ribbon-item" data-systool="browser" data-label="Browser">ğŸŒ Browser</button>
          <button class="ribbon-item" data-systool="mobile" data-label="Mobile">ğŸ“± Mobile</button>
        </div>
      </div>
      <div class="ribbon-category" data-category="ops">
        <div class="ribbon-icon" title="Ops">ğŸ“ˆ</div>
        <div class="ribbon-flyout">
          <div class="flyout-title">Ops</div>
          <button class="ribbon-item" data-systool="monitor" data-label="Monitor">ğŸ“ˆ Monitor</button>
          <button class="ribbon-item" data-systool="logger" data-label="Logger">ğŸ“œ Logger</button>
          <button class="ribbon-item" data-systool="scheduler" data-label="Scheduler">&#9202; Scheduler</button>
        </div>
      </div>
      <div class="ribbon-category" data-category="security">
        <div class="ribbon-icon" title="Security & Integration">ğŸ”’</div>
        <div class="ribbon-flyout">
          <div class="flyout-title">Security & Integration</div>
          <button class="ribbon-item" data-systool="notification" data-label="Notification">ğŸ”” Notification</button>
          <button class="ribbon-item" data-systool="auth" data-label="Auth">ğŸ”’ Auth</button>
          <button class="ribbon-item" data-systool="externalapi" data-label="External API">ğŸ”— External API</button>
        </div>
      </div>
      <div class="ribbon-category" data-category="azurestorage">
        <div class="ribbon-icon" title="Azure Storage">â˜</div>
        <div class="ribbon-flyout">
          <div class="flyout-title">Azure Storage</div>
          <button class="ribbon-item" data-systool="blobstorage" data-label="Blob Storage">&#x1F4E6; Blob Storage</button>
          <button class="ribbon-item" data-systool="filestorage" data-label="File Storage">&#x1F4C1; File Storage</button>
          <button class="ribbon-item" data-systool="queuestorage" data-label="Queue Storage">&#x1F4EC; Queue Storage</button>
          <button class="ribbon-item" data-systool="tablestorage" data-label="Table Storage">&#x1F4CA; Table Storage</button>
          <button class="ribbon-item" data-systool="datalake" data-label="Data Lake">&#x1F30A; Data Lake</button>
          <button class="ribbon-item" data-systool="manageddisks" data-label="Managed Disks">&#x1F4BF; Managed Disks</button>
        </div>
      </div>
    </div>

    <!-- Canvas -->
    <div id="canvasWrapper">
      <canvas id="drawCanvas"></canvas>
    </div>

    <!-- Right Style Panel -->
    <div id="stylePanel" class="style-panel">
      <div class="panel-header">
        <span>Style</span>
        <button id="panelToggle" class="panel-toggle" title="Toggle Panel">&#9654;</button>
      </div>
      <div class="panel-body" id="panelBody">

        <!-- Colors Section -->
        <div class="panel-section">
          <div class="panel-label">Colors</div>
          <div class="panel-row">
            <label class="panel-color-label">
              <span class="color-swatch" id="strokeSwatch"></span>
              <input type="color" id="strokeColor" value="#1e1e1e">
              <span class="color-text">Stroke</span>
            </label>
            <label class="panel-color-label">
              <span class="color-swatch" id="fillSwatch" style="background: transparent; border: 2px dashed #888;"></span>
              <input type="color" id="fillColor" value="#ffffff">
              <span class="color-text">Fill</span>
            </label>
          </div>
        </div>

        <!-- Stroke Section -->
        <div class="panel-section">
          <div class="panel-label">Stroke</div>
          <div class="panel-field">
            <span class="field-label">Width</span>
            <select id="strokeWidth" class="panel-select">
              <option value="0.5" selected>Thin</option>
              <option value="1">Medium</option>
              <option value="2">Normal</option>
            </select>
          </div>
          <div class="panel-field">
            <span class="field-label">Style</span>
            <select id="strokeDashSelect" class="panel-select">
              <option value="solid">â”€â”€ Solid</option>
              <option value="dashed">â•Œâ•Œ Dashed</option>
              <option value="dotted">Â·Â·Â· Dotted</option>
              <option value="dashdot">â•ŒÂ· Dash-Dot</option>
            </select>
          </div>
        </div>

        <!-- Shape Section -->
        <div class="panel-section">
          <div class="panel-label">Shape</div>
          <div class="panel-field">
            <span class="field-label">Edges</span>
            <select id="edgeStyleSelect" class="panel-select">
              <option value="sharp">Sharp</option>
              <option value="round">Rounded</option>
            </select>
          </div>
          <div class="panel-field">
            <span class="field-label">Fill</span>
            <select id="fillStyleSelect" class="panel-select">
              <option value="none">No Fill</option>
              <option value="solid">Solid Fill</option>
              <option value="hachure">Hachure</option>
              <option value="cross-hatch">Cross-Hatch</option>
              <option value="zigzag">Zigzag</option>
            </select>
          </div>
        </div>

        <!-- Text Section -->
        <div class="panel-section">
          <div class="panel-label">Text Align</div>
          <div class="panel-row align-row">
            <button class="panel-icon-btn align-btn" data-valign="top" title="Align Top">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="4" y1="4" x2="20" y2="4"/>
                <line x1="12" y1="4" x2="12" y2="18"/>
                <line x1="8" y1="8" x2="12" y2="4"/>
                <line x1="16" y1="8" x2="12" y2="4"/>
              </svg>
            </button>
            <button class="panel-icon-btn align-btn" data-valign="middle" title="Align Middle">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="4" y1="12" x2="20" y2="12"/>
                <line x1="12" y1="6" x2="12" y2="18"/>
                <polyline points="8 9 12 6 16 9"/>
                <polyline points="8 15 12 18 16 15"/>
              </svg>
            </button>
            <button class="panel-icon-btn align-btn active" data-valign="bottom" title="Align Bottom">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="4" y1="20" x2="20" y2="20"/>
                <line x1="12" y1="6" x2="12" y2="20"/>
                <line x1="8" y1="16" x2="12" y2="20"/>
                <line x1="16" y1="16" x2="12" y2="20"/>
              </svg>
            </button>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Hidden text input for inline editing -->
  <textarea id="textInput" style="display:none"></textarea>

  <!-- Context Menu -->
  <div id="contextMenu" style="display:none">
    <div class="ctx-item" data-action="duplicate">Duplicate</div>
    <div class="ctx-item" data-action="delete">Delete</div>
    <div class="ctx-separator"></div>
    <div class="ctx-item" data-action="bringFront">Bring to Front</div>
    <div class="ctx-item" data-action="sendBack">Send to Back</div>
  </div>

  <!-- Scripts -->
  <script src="js/utils.js?v=4"></script>
  <script src="js/shapes.js?v=4"></script>
  <script src="js/history.js?v=4"></script>
  <script src="js/canvas.js?v=4"></script>
  <script src="js/connectors.js?v=4"></script>
  <script src="js/tools.js?v=4"></script>
  <script src="js/export.js?v=4"></script>
  <script src="js/app.js?v=4"></script>
</body>
</html>
